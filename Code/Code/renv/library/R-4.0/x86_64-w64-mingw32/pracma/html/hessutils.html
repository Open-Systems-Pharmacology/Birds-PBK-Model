<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Hessian utilities</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for Hessian utilities {pracma}"><tr><td>Hessian utilities {pracma}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Hessian utilities</h2>

<h3>Description</h3>

<p>Fast multiplication of Hessian and vector where computation of the full 
Hessian is not needed. Or determine the diagonal of the Hessian when
non-diagonal entries are not needed or are nearly zero.
</p>


<h3>Usage</h3>

<pre>
  hessvec(f, x, v, csd = FALSE, ...)

  hessdiag(f, x, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>f</code></td>
<td>
<p>function whose hessian is to be computed.</p>
</td></tr>
<tr valign="top"><td><code>x</code></td>
<td>
<p>point in <code>R^n</code>.</p>
</td></tr>
<tr valign="top"><td><code>v</code></td>
<td>
<p>vector of length <code>n</code>.</p>
</td></tr>
<tr valign="top"><td><code>csd</code></td>
<td>
<p>logocal, shall complex-step be applied.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>more arguments to be passed to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>hessvec</code> computes the product of a Hessian of a function
times a vector without deriving the full Hessian by approximating
the gradient (see the reference). If the function allows for the
complex-step method, the gradient can be calculated much more
accurate (see <code>grad_csd</code>).
</p>
<p><code>hessdiag</code> computes only the diagonal of the Hessian by
applying the central difference formula of second order to
approximate the partial derivatives.
</p>


<h3>Value</h3>

<p><code>hessvec</code> returns the product <code>H(f,x) * v</code> as a vector.
</p>
<p><code>hessdiag</code> returns the diagonal of the Hessian of <code>f</code>.
</p>


<h3>References</h3>

<p>B.A. Pearlmutter, Fast Exact Multiplication by the Hessian, Neural Computation (1994), Vol. 6, Issue 1, pp. 147-160.
</p>


<h3>See Also</h3>

<p><code><a href="hessian.html">hessian</a></code>
</p>


<h3>Examples</h3>

<pre>
  ## Not run: 
    set.seed(1237); n &lt;- 100
    a &lt;- runif(n); b &lt;- rnorm(n)
    fn &lt;- function(x, a, b) sum(exp(-a*x)*sin(b*pi*x))
    x0 &lt;- rep(1, n)
    v0 &lt;- rexp(n, rate=0.1)
    
    # compute with full hessian
    h0 &lt;- hessian(fn, x0, a = a, b = b)             # n=100 runtimes
    v1 &lt;- c(h0 %*% v0)                              # 0.167   sec
    
    v2 &lt;- hessvec(fn, x0, v0, a = a, b = b)         # 0.00209 sec
    v3 &lt;- hessvec(fn, x0, v0, csd=TRUE,a=a, b=b)    # 0.00145 sec
    v4 &lt;- hessdiag(fn, x0, a = a, b = b) * v0       # 0.00204 sec
    
    # compare with exact analytical Hessian
    hex &lt;- diag((a^2-b^2*pi^2)*exp(-a*x0)*sin(b*pi*x0) - 
                 2*a*b*pi*exp(-a*x0)*cos(b*pi*x0))
    vex &lt;- c(hex %*% v0)

    max(abs(vex - v1))          # 2.48e-05
    max(abs(vex - v2))          # 7.15e-05
    max(abs(vex - v3))          # 0.09e-05
    max(abs(vex - v4))          # 2.46e-05 
## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>pracma</em> version 2.4.2 <a href="00Index.html">Index</a>]</div>
</body></html>
